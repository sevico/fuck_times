!function(e){var o,a,t,i,s=1,n=this,r=n.postMessage&&!/opera/.test(navigator.userAgent.toLowerCase());e.postMessage=function(o,a,t){a&&(o="string"==typeof o?o:e.param(o),t=t||parent,r?t.postMessage(o,a.replace(/([^:]+:\/\/[^\/]+).*/,"$1")):a&&(t.location=a.replace(/#.*$/,"")+"#"+ +new Date+s++ +"&"+o))},e.receiveMessage=i=function(s,d,c){r?(s&&(t&&i(),t=function(o){return"string"==typeof d&&o.origin!==d||e.isFunction(d)&&!1===d(o.origin)?!1:void s(o)}),n.addEventListener?n[s?"addEventListener":"removeEventListener"]("message",t,!1):n[s?"attachEvent":"detachEvent"]("onmessage",t)):(o&&clearInterval(o),o=null,s&&(o=setInterval(function(){var e=document.location.hash,o=/^#?\d+&/;e!==a&&o.test(e)&&(a=e,s({data:e.replace(o,"")}))},"number"==typeof d?d:"number"==typeof c?c:100)))}}(jQuery),function(e){e.getUrlParam=function(e){var o=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),a=window.location.search.substr(1).match(o);return null!=a?unescape(a[2]):null}}(jQuery),function(e){var o=e("#sso_script"),a=o.attr("data-ssoSite"),t=o.attr("data-ssoReferer"),i=o.attr("data-ssoScene"),s=o.attr("data-ssoSiteid");t=void 0!=t?t:"",i=void 0!=i?i:"";var n=e.getUrlParam("tid");n=n?n:"";var r=a+"/login?referer="+t+"&siteid="+s+"&scene="+i+"#"+encodeURIComponent(location.href),d=a+"/register?tid="+n+"&referer="+t+"&siteid="+s+"&scene="+i+"#"+encodeURIComponent(location.href),c=a+"/password/changepwd?siteid="+s+"#"+encodeURIComponent(location.href);if("activity"==e.getUrlParam("special")&&(d=a+"/register?tid="+n+"&referer="+e.getUrlParam("referer")+"&special=activity&siteid="+s+"&scene="+i+"#"+encodeURIComponent(location.href)),0==e("iframe[name^='sso-']").length){var l=a+"/public/pc/css/sso.dialogPassport.css";e("head").append('<link rel="stylesheet" href="'+l+'"/>')}e.extend({ssoDialogLogin:function(o){var t=e('<div class="sso_layer"></div><div class="sso_dialog"><div class="sso_dialog_header"><span class="sso_dialog_title">登录</span><button class="sso_dialog_close">×</button></div><div class="sso_dialog_content"><iframe frameborder="0" scrolling="no" onload=""></iframe></div></div>');t.appendTo("body").find("iframe").attr("src",r),t.on("click",".sso_dialog_close",function(){t.remove()}),e.receiveMessage(function(a){var i=t.find("iframe");if(e.isNumeric(a.data)){i.css("height",a.data+"px");var s=t.find(".sso_dialog_header").height(),n=t.find(".sso_dialog_content").outerHeight(),d=s+n;e(".sso_dialog").css({height:d+"px","margin-top":0-d/2+"px"})}else"reload"==a.data?window.location.reload():"string"==typeof a.data&&e.ajax({type:"get",url:decodeURIComponent(a.data),success:function(t){if("string"==typeof o)return void(window.location.href=o);if("function"==typeof o){o(a);return void(1==o&&window.location.reload())}if(0!=o)return 1==o?void window.location.reload():void e.postMessage(t,r,i.get(0).contentWindow)}})},a)},ssoDialogRegist:function(o){var i=e('<div class="sso_layer"></div><div class="sso_dialog"><div class="sso_dialog_header"><span class="sso_dialog_title">注册</span><button class="sso_dialog_close">×</button></div><div class="sso_dialog_content"><iframe frameborder="0" scrolling="no" onload=""></iframe></div></div>');i.appendTo("body").find("iframe").attr("src",d),i.on("click",".sso_dialog_close",function(){i.remove()}),e.receiveMessage(function(a){var s=i.find("iframe");if(e.isNumeric(a.data)){s.css("height",a.data+"px");var n=i.find(".sso_dialog_header").height(),d=i.find(".sso_dialog_content").outerHeight(),c=n+d;i.find(".sso_dialog").css({height:c+"px","margin-top":0-c/2+"px"})}else"string"==typeof a.data&&e.ajax({type:"get",url:decodeURIComponent(a.data),success:function(i){if("string"==typeof o)return void(window.location.href=o);if("function"==typeof o){o(a);return void(1==o&&window.location.reload())}if(0!=o)return 1==o?void window.location.reload():""==t?void window.location.reload():void e.postMessage(i,r,s.get(0).contentWindow)}})},a)},ssoPageLogin:function(){var o=e("iframe[name='sso-LoginIframe']");o.attr("src",r),e.receiveMessage(function(a){e.isNumeric(a.data)?o.css("height",a.data+"px"):"string"==typeof a.data&&e.ajax({type:"get",url:decodeURIComponent(a.data),success:function(a){""==t?window.location.href="/":e.postMessage(a,r,o.get(0).contentWindow)}})},a)},ssoPageRegist:function(){var o=e("iframe[name='sso-RegistIframe']");o.attr("src",d),e.receiveMessage(function(a){e.isNumeric(a.data)?o.css("height",a.data+"px"):"string"==typeof a.data&&e.ajax({type:"get",url:decodeURIComponent(a.data),success:function(a){""==t?window.location.href="/":e.postMessage(a,d,o.get(0).contentWindow)}})},a)},ssoPageChangepwd:function(){var o=e("iframe[name='sso-ChangepwdIframe']");o.attr("src",c),e.receiveMessage(function(a){e.isNumeric(a.data)?o.css("height",a.data+"px"):"string"==typeof a.data&&e.postMessage("success",c,o.get(0).contentWindow)},a)},bbsActivityLogin:function(o){var i=a+"/login?special=activity&referer="+t+"&siteid="+s+"#"+encodeURIComponent(location.href),n=e('<div class="sso_layer"></div><div class="sso_dialog" id="activity_login"><div class="sso_dialog_header"><button class="sso_dialog_close">×</button></div><div class="sso_dialog_content"><iframe frameborder="0" scrolling="no" ></iframe></div></div>');n.appendTo("body").find("iframe").attr("src",i),n.on("click",".sso_dialog_close",function(){n.remove()}),e.receiveMessage(function(a){var t=n.find("iframe");if(e.isNumeric(a.data)){t.css("height",a.data+"px");var s=n.find(".sso_dialog_header").height(),r=n.find(".sso_dialog_content").outerHeight(),d=s+r;e(".sso_dialog").css({height:d+"px","margin-top":0-d/2+"px"})}else"reload"==a.data?window.location.reload():"string"==typeof a.data&&e.ajax({type:"get",url:decodeURIComponent(a.data),success:function(s){if("string"==typeof o)return void(window.location.href=o);if("function"==typeof o){o(a);return void(1==o&&window.location.reload())}if(0!=o)return 1==o?void window.location.reload():void e.postMessage(s,i,t.get(0).contentWindow)}})},a)}})}(jQuery),0!=$("iframe[name='sso-LoginIframe']").length?$.ssoPageLogin():0!=$("iframe[name='sso-RegistIframe']").length?$.ssoPageRegist():0!=$("iframe[name='sso-ChangepwdIframe']").length&&$.ssoPageChangepwd();